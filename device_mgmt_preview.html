<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í∏∞Í∏∞Í¥ÄÎ¶¨ ÌéòÏù¥ÏßÄ - ÎØ∏Î¶¨Î≥¥Í∏∞</title>
    <style>
        /* Í∏∞Î≥∏ Ïä§ÌÉÄÏùº (customer.css) */
        :root {
            --border: #e5e7eb;
            --muted: #6b7280;
            --fg: #111827;
            --bg: #f8fafc;
            --white: #fff;
            --brand: #10b981;
            --accent: #047857;
            --warn: #dc2626;
            --ok: #065f46;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            background: var(--bg);
            color: var(--fg);
            font-family: ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans KR', Arial, sans-serif;
        }

        .wrap {
            padding: 16px;
            display: grid;
            gap: 16px;
        }

        .card {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 1px 2px rgba(0, 0, 0, .03);
        }

        .card-hd {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }

        .card-ttl {
            font-weight: 700;
            color: var(--accent);
        }

        .card-sub {
            font-size: 12px;
            color: var(--muted);
        }

        .card-bd {
            padding: 16px;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .kpi {
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 12px;
            background: #ecfdf5;
        }

        .kpi .v {
            font-size: 20px;
            font-weight: 700;
            color: var(--ok);
        }

        .small {
            font-size: 12px;
            color: var(--muted);
        }

        .input {
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 8px 10px;
            font-size: 13px;
            background: #fff;
        }

        .select {
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 8px 10px;
            font-size: 13px;
            background: #fff;
        }

        .btn {
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: #fff;
            cursor: pointer;
            font-size: 12px;
        }

        .btn.primary {
            background: #ecfdf5;
            border-color: #a7f3d0;
            color: var(--ok);
        }

        .sticky-filter {
            position: sticky;
            top: 0;
            background: #fff;
            z-index: 15;
            border-bottom: 1px solid var(--border);
            backdrop-filter: saturate(140%) blur(2px);
        }

        .sticky-filter .inner {
            display: flex;
            align-items: center;
            gap: 10px 12px;
            padding: 10px 16px;
            flex-wrap: wrap;
        }

        .img-row {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: nowrap;
        }

        .img-item {
            position: relative;
            width: 75px;
            height: 75px;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            cursor: pointer;
        }

        .tooltip {
            visibility: hidden;
            position: absolute;
            bottom: 110%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 11px;
            white-space: nowrap;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            max-width: 200px;
            text-align: center;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.9);
        }

        .img-item:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        .gear-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border);
            border-radius: 50%;
            background: #fff;
            box-shadow: 0 1px 3px rgba(0, 0, 0, .1);
            cursor: pointer;
            font-size: 16px;
            line-height: 32px;
            text-align: center;
            padding: 0;
            flex-shrink: 0;
        }

        .gear-btn:hover {
            background: #f9fafb;
        }

        /* Í≥†ÎèÑÌôîÎêú Ïä§ÌÉÄÏùº */
        .enhanced-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
        }

        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            min-width: 200px;
        }

        .search-box input {
            flex: 1;
            min-width: 200px;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .table-wrapper {
            overflow-x: auto;
            margin-top: 12px;
        }

        .table-enhanced {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .table-enhanced thead {
            background: #f9fafb;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table-enhanced th {
            padding: 12px 10px;
            border-bottom: 2px solid var(--border);
            text-align: left;
            font-weight: 700;
            color: var(--accent);
            white-space: nowrap;
            cursor: pointer;
            user-select: none;
        }

        .table-enhanced th:hover {
            background: #f3f4f6;
        }

        .table-enhanced th.sortable::after {
            content: ' ‚Üï';
            opacity: 0.3;
            font-size: 10px;
        }

        .table-enhanced th.sort-asc::after {
            content: ' ‚Üë';
            opacity: 1;
            color: var(--accent);
        }

        .table-enhanced th.sort-desc::after {
            content: ' ‚Üì';
            opacity: 1;
            color: var(--accent);
        }

        .table-enhanced td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
            vertical-align: middle;
        }

        .table-enhanced tbody tr {
            transition: background-color 0.15s;
        }

        .table-enhanced tbody tr:nth-child(even) {
            background: #fafbfc;
        }

        .table-enhanced tbody tr:hover {
            background: #f0fdf4;
        }

        .table-enhanced tbody tr.filtered-out {
            display: none;
        }

        .pagination {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 16px;
            gap: 12px;
            flex-wrap: wrap;
        }

        .pagination-info {
            font-size: 12px;
            color: var(--muted);
        }

        .pagination-controls {
            display: flex;
            gap: 6px;
        }

        .page-btn {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: #fff;
            cursor: pointer;
            font-size: 12px;
            min-width: 36px;
        }

        .page-btn:hover:not(:disabled) {
            background: #f9fafb;
        }

        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .page-btn.active {
            background: var(--accent);
            color: #fff;
            border-color: var(--accent);
        }

        .delete-btn {
            padding: 4px 8px;
            border: 1px solid #fecaca;
            border-radius: 6px;
            background: #fef2f2;
            color: #b91c1c;
            cursor: pointer;
            font-size: 11px;
        }

        .delete-btn:hover {
            background: #fee2e2;
        }

        .icon-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        @media (max-width: 768px) {
            .enhanced-header {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                width: 100%;
            }

            .action-buttons {
                width: 100%;
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- ÌÜµÍ≥Ñ ÎåÄÏãúÎ≥¥Îìú -->
    <div class="wrap">
        <section class="card">
            <div class="card-hd">
                <div class="card-ttl">ÌÜµÍ≥Ñ ÏöîÏïΩ</div>
            </div>
            <div class="card-bd">
                <div class="kpi-grid">
                    <div class="kpi">
                        <div class="small">Ï¥ù Í∏∞Í∏∞ Ïàò</div>
                        <div class="v">9ÎåÄ</div>
                    </div>
                    <div class="kpi">
                        <div class="small">ÏÇ¨ÏóÖÏû• Ïàò</div>
                        <div class="v">2Í∞ú</div>
                    </div>
                    <div class="kpi">
                        <div class="small">ÏÑ§Ïπò Ïû•ÏÜå</div>
                        <div class="v">7Í≥≥</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- ÌïÑÌÑ∞ -->
    <div class="sticky-filter">
        <div class="inner">
            <span class="small" style="font-weight:700;color:var(--accent)">ÏÇ¨ÏóÖÏû•</span>
            <select id="branchSel" class="select">
                <option value="">Ï†ÑÏ≤¥</option>
                <option value="AÏßÄÏ†ê">AÏßÄÏ†ê</option>
                <option value="BÏßÄÏ†ê">BÏßÄÏ†ê</option>
            </select>

            <span class="small" style="font-weight:700;color:var(--accent)">Í∑∏Î£π</span>
            <select id="groupSel" class="select">
                <option value="">Ï†ÑÏ≤¥</option>
            </select>

            <span class="small" style="font-weight:700;color:var(--accent)">ÏÑ§ÏπòÏúÑÏπò</span>
            <select id="locationSel" class="select">
                <option value="">Ï†ÑÏ≤¥</option>
            </select>

            <button id="filterBtn" class="btn primary icon-btn">
                <span>ÌïÑÌÑ∞ Ï†ÅÏö©</span>
            </button>

            <button id="resetFilter" class="btn">Ï¥àÍ∏∞Ìôî</button>
        </div>
    </div>

    <div class="wrap">
        <section class="card" id="tab-Devices">
            <div class="card-hd">
                <div>
                    <div class="card-ttl">Í∏∞Í∏∞Í¥ÄÎ¶¨</div>
                    <div class="card-sub">ÏÑ§ÏπòÏùº/Ïû•ÏÜå/ÏãúÎ¶¨Ïñº ¬∑ ÏÑ†ÌÉù Ìñ•/ÏΩòÌÖêÏ∏†</div>
                </div>
                <div class="enhanced-header">
                    <div class="search-box">
                        <input id="searchInput" class="input" placeholder="üîç ÏãúÎ¶¨Ïñº Î≤àÌò∏ ÎòêÎäî ÏÑ§Ïπò Ïû•ÏÜå Í≤ÄÏÉâ...">
                    </div>
                    <div class="action-buttons">
                        <button class="btn primary icon-btn" id="exportCSV">
                            <span>üì• CSV ÎÇ¥Î≥¥ÎÇ¥Í∏∞</span>
                        </button>
                        <button class="btn" id="resetSeed">üîÑ ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Ïû¨ÏÑ§Ï†ï</button>
                    </div>
                </div>
            </div>
            <div class="card-bd">
                <div class="table-wrapper">
                    <table class="table-enhanced" id="deviceTbl">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="branch">ÏÇ¨ÏóÖÏû•</th>
                                <th class="sortable" data-sort="group">Í∑∏Î£π</th>
                                <th class="sortable" data-sort="location">ÏÑ§Ïπò Ïû•ÏÜå</th>
                                <th class="sortable" data-sort="serial">ÏãúÎ¶¨Ïñº</th>
                                <th class="sortable" data-sort="date">ÏÑ§ÏπòÏùº</th>
                                <th>Ìñ•</th>
                                <th>ÏΩòÌÖêÏ∏†</th>
                                <th>Í¥ÄÎ¶¨</th>
                            </tr>
                        </thead>
                        <tbody id="deviceTbody">
                            <tr data-row="0">
                                <td data-branch="AÏßÄÏ†ê">AÏßÄÏ†ê</td>
                                <td data-group="2Ï∏µ">2Ï∏µ</td>
                                <td data-location="ÌöåÏùòÏã§ 1">ÌöåÏùòÏã§ 1</td>
                                <td data-serial="AP5-250001"><strong>AP5-250001</strong></td>
                                <td data-date="2025-01-10">2025-01-10</td>
                                <td>
                                    <div class="img-row">
                                        <div class="img-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                            <span class="tooltip">ÎùºÎ≤§Îçî</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                            <span class="tooltip">Î°úÏ¶à</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                            <span class="tooltip">ÏãúÌä∏Îü¨Ïä§</span>
                                        </div>
                                        <button class="gear-btn" title="Ìñ• ÏÑ§Ï†ï">‚öô</button>
                                    </div>
                                </td>
                                <td>
                                    <div class="img-row">
                                        <div class="img-item" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                            <span class="tooltip">Í¥ëÍ≥† ÏΩòÌÖêÏ∏† A</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                            <span class="tooltip">Í¥ëÍ≥† ÏΩòÌÖêÏ∏† B</span>
                                        </div>
                                        <button class="gear-btn" title="ÏΩòÌÖêÏ∏† ÏÑ§Ï†ï">‚öô</button>
                                    </div>
                                </td>
                                <td>
                                    <button class="delete-btn" onclick="deleteRow(0)">ÏÇ≠Ï†ú</button>
                                </td>
                            </tr>
                            <tr data-row="1">
                                <td data-branch="AÏßÄÏ†ê">AÏßÄÏ†ê</td>
                                <td data-group="ÏßÄÌïò">ÏßÄÌïò</td>
                                <td data-location="Ï†ÑÍ∏∞Ïã§">Ï†ÑÍ∏∞Ïã§</td>
                                <td data-serial="AP5-250002"><strong>AP5-250002</strong></td>
                                <td data-date="2025-01-10">2025-01-10</td>
                                <td>
                                    <div class="img-row">
                                        <div class="img-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                            <span class="tooltip">ÎØºÌä∏</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                            <span class="tooltip">Î∞îÎãêÎùº</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                            <span class="tooltip">ÌóàÎ∏å</span>
                                        </div>
                                        <button class="gear-btn" title="Ìñ• ÏÑ§Ï†ï">‚öô</button>
                                    </div>
                                </td>
                                <td>
                                    <div class="img-row">
                                        <div class="img-item" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                            <span class="tooltip">Í¥ëÍ≥† ÏΩòÌÖêÏ∏† C</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                            <span class="tooltip">Í¥ëÍ≥† ÏΩòÌÖêÏ∏† D</span>
                                        </div>
                                        <button class="gear-btn" title="ÏΩòÌÖêÏ∏† ÏÑ§Ï†ï">‚öô</button>
                                    </div>
                                </td>
                                <td>
                                    <button class="delete-btn" onclick="deleteRow(1)">ÏÇ≠Ï†ú</button>
                                </td>
                            </tr>
                            <tr data-row="2">
                                <td data-branch="BÏßÄÏ†ê">BÏßÄÏ†ê</td>
                                <td data-group="1Ï∏µ">1Ï∏µ</td>
                                <td data-location="Î¶¨ÏÖâÏÖò">Î¶¨ÏÖâÏÖò</td>
                                <td data-serial="AP5-250003"><strong>AP5-250003</strong></td>
                                <td data-date="2025-01-10">2025-01-10</td>
                                <td>
                                    <div class="img-row">
                                        <div class="img-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                            <span class="tooltip">Ïö∞Îîî</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                            <span class="tooltip">Î®∏Ïä§ÌÅ¨</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                            <span class="tooltip">Ïû¨Ïä§ÎØº</span>
                                        </div>
                                        <button class="gear-btn" title="Ìñ• ÏÑ§Ï†ï">‚öô</button>
                                    </div>
                                </td>
                                <td>
                                    <div class="img-row">
                                        <div class="img-item" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                            <span class="tooltip">Í¥ëÍ≥† ÏΩòÌÖêÏ∏† E</span>
                                        </div>
                                        <div class="img-item" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                            <span class="tooltip">Í¥ëÍ≥† ÏΩòÌÖêÏ∏† F</span>
                                        </div>
                                        <button class="gear-btn" title="ÏΩòÌÖêÏ∏† ÏÑ§Ï†ï">‚öô</button>
                                    </div>
                                </td>
                                <td>
                                    <button class="delete-btn" onclick="deleteRow(2)">ÏÇ≠Ï†ú</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
                <div class="pagination" id="pagination">
                    <div class="pagination-info" id="paginationInfo">
                        Ï†ÑÏ≤¥ <span id="totalRows">0</span>Í∞ú Ï§ë <span id="displayedRows">0</span>Í∞ú ÌëúÏãú
                    </div>
                    <div class="pagination-controls" id="paginationControls">
                        <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê® -->
                    </div>
                </div>

                <div class="small" style="margin-top:12px">
                    ‚Äª Ìñ• 6Ï¢Ö Î¨¥ÏÉÅ Ï†úÍ≥µ, ÏÑ§ÏπòÏùº Í∏∞Ï§Ä 2Í∞úÏõîÎßàÎã§ ÏûêÎèô Í≥µÍ∏â. Ï≤´ Íµ¨ÏûÖ Ïãú 1Í∞úÎäî Í≥†Í∞ù ÏÑ†ÌÉù, ÎÇòÎ®∏ÏßÄÎäî ÎûúÎç§ Í≥µÍ∏â.
                </div>
            </div>
        </section>
    </div>

    <script>
        // Îç∞Ïù¥ÌÑ∞
        var filterData = [
            {
                "branch": "AÏßÄÏ†ê",
                "groups": [
                    {
                        "group": "1Ï∏µ",
                        "locations": [
                            { "location": "ÌôÄ" },
                            { "location": "ÌôîÏû•Ïã§" },
                            { "location": "ÌÉïÎπÑÏã§" }
                        ]
                    },
                    {
                        "group": "2Ï∏µ",
                        "locations": [
                            { "location": "ÌöåÏùòÏã§ 1" },
                            { "location": "ÌöåÏùòÏã§ 2" },
                            { "location": "Ï∞ΩÍ≥†" }
                        ]
                    },
                    {
                        "group": "ÏßÄÌïò",
                        "locations": [
                            { "location": "Ï†ÑÍ∏∞Ïã§" },
                            { "location": "Í∏∞Í≥ÑÏã§" }
                        ]
                    }
                ]
            },
            {
                "branch": "BÏßÄÏ†ê",
                "groups": [
                    {
                        "group": "1Ï∏µ",
                        "locations": [
                            { "location": "Î¶¨ÏÖâÏÖò" },
                            { "location": "ÌôÄ" },
                            { "location": "ÌôîÏû•Ïã§" }
                        ]
                    },
                    {
                        "group": "Î≥ÑÍ¥Ä",
                        "locations": [
                            { "location": "ÌöåÏùòÏã§ A" },
                            { "location": "ÌöåÏùòÏã§ B" },
                            { "location": "ÎùºÏö¥ÏßÄ" }
                        ]
                    },
                    {
                        "group": "Ïò•ÏÉÅ",
                        "locations": [
                            { "location": "Ìù°Ïó∞Íµ¨Ïó≠" },
                            { "location": "Ìú¥Í≤åÍ≥µÍ∞Ñ" }
                        ]
                    }
                ]
            }
        ];

        var currentSort = { column: null, direction: 'asc' };
        var currentPage = 1;
        var rowsPerPage = 10;

        // ÌïÑÌÑ∞ Í∏∞Îä•
        document.getElementById('branchSel').addEventListener('change', function() {
            var branch = this.value;
            var groupSel = document.getElementById('groupSel');
            var locationSel = document.getElementById('locationSel');

            groupSel.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';
            locationSel.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';

            if(!branch) return;

            var branchData = filterData.find(function(item) { return item.branch === branch; });
            if(!branchData) return;

            branchData.groups.forEach(function(g) {
                var opt = document.createElement('option');
                opt.value = g.group;
                opt.textContent = g.group;
                groupSel.appendChild(opt);
            });
        });

        document.getElementById('groupSel').addEventListener('change', function() {
            var branch = document.getElementById('branchSel').value;
            var group = this.value;
            var locationSel = document.getElementById('locationSel');

            locationSel.innerHTML = '<option value="">Ï†ÑÏ≤¥</option>';

            if(!branch || !group) return;

            var branchData = filterData.find(function(item) { return item.branch === branch; });
            if(!branchData) return;

            var groupData = branchData.groups.find(function(g) { return g.group === group; });
            if(!groupData) return;

            groupData.locations.forEach(function(loc) {
                var opt = document.createElement('option');
                opt.value = loc.location;
                opt.textContent = loc.location;
                locationSel.appendChild(opt);
            });
        });

        document.getElementById('filterBtn').addEventListener('click', applyFilters);
        document.getElementById('resetFilter').addEventListener('click', function() {
            document.getElementById('branchSel').value = '';
            document.getElementById('groupSel').value = '';
            document.getElementById('locationSel').value = '';
            document.getElementById('searchInput').value = '';
            applyFilters();
        });

        function applyFilters() {
            var branchFilter = document.getElementById('branchSel').value.toLowerCase();
            var groupFilter = document.getElementById('groupSel').value.toLowerCase();
            var locationFilter = document.getElementById('locationSel').value.toLowerCase();
            var searchQuery = document.getElementById('searchInput').value.toLowerCase();

            var rows = document.querySelectorAll('#deviceTbody tr');
            var visibleCount = 0;

            rows.forEach(function(row) {
                var branch = (row.querySelector('[data-branch]')?.dataset.branch || '').toLowerCase();
                var group = (row.querySelector('[data-group]')?.dataset.group || '').toLowerCase();
                var location = (row.querySelector('[data-location]')?.dataset.location || '').toLowerCase();
                var serial = (row.querySelector('[data-serial]')?.dataset.serial || '').toLowerCase();

                var matchBranch = !branchFilter || branch === branchFilter;
                var matchGroup = !groupFilter || group === groupFilter;
                var matchLocation = !locationFilter || location === locationFilter;
                var matchSearch = !searchQuery || serial.includes(searchQuery) || location.includes(searchQuery);

                if (matchBranch && matchGroup && matchLocation && matchSearch) {
                    row.classList.remove('filtered-out');
                    visibleCount++;
                } else {
                    row.classList.add('filtered-out');
                }
            });

            updatePaginationInfo();
            renderPagination();
        }

        document.getElementById('searchInput').addEventListener('input', function() {
            applyFilters();
        });

        // Ï†ïÎ†¨ Í∏∞Îä•
        document.querySelectorAll('.table-enhanced th.sortable').forEach(function(header) {
            header.addEventListener('click', function() {
                var column = this.dataset.sort;

                if (currentSort.column === column) {
                    currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSort.column = column;
                    currentSort.direction = 'asc';
                }

                document.querySelectorAll('.table-enhanced th').forEach(function(th) {
                    th.classList.remove('sort-asc', 'sort-desc');
                });
                this.classList.add(currentSort.direction === 'asc' ? 'sort-asc' : 'sort-desc');

                sortTable(column, currentSort.direction);
            });
        });

        function sortTable(column, direction) {
            var tbody = document.getElementById('deviceTbody');
            var rows = Array.from(tbody.querySelectorAll('tr'));

            rows.sort(function(a, b) {
                var aVal = a.querySelector('[data-' + column + ']')?.dataset[column] || '';
                var bVal = b.querySelector('[data-' + column + ']')?.dataset[column] || '';

                if (direction === 'asc') {
                    return aVal.localeCompare(bVal);
                } else {
                    return bVal.localeCompare(aVal);
                }
            });

            rows.forEach(function(row) {
                tbody.appendChild(row);
            });
        }

        // ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò
        function updatePaginationInfo() {
            var allRows = document.querySelectorAll('#deviceTbody tr');
            var visibleRows = document.querySelectorAll('#deviceTbody tr:not(.filtered-out)');

            document.getElementById('totalRows').textContent = allRows.length;
            document.getElementById('displayedRows').textContent = visibleRows.length;
        }

        function renderPagination() {
            var visibleRows = document.querySelectorAll('#deviceTbody tr:not(.filtered-out)');
            var totalPages = Math.ceil(visibleRows.length / rowsPerPage);

            var controls = document.getElementById('paginationControls');
            controls.innerHTML = '';

            var prevBtn = document.createElement('button');
            prevBtn.className = 'page-btn';
            prevBtn.textContent = '‚Äπ';
            prevBtn.disabled = currentPage === 1;
            prevBtn.onclick = function() {
                if (currentPage > 1) {
                    currentPage--;
                    showPage(currentPage);
                }
            };
            controls.appendChild(prevBtn);

            for (var i = 1; i <= totalPages; i++) {
                var pageBtn = document.createElement('button');
                pageBtn.className = 'page-btn' + (i === currentPage ? ' active' : '');
                pageBtn.textContent = i;
                pageBtn.dataset.page = i;
                pageBtn.onclick = function() {
                    currentPage = parseInt(this.dataset.page);
                    showPage(currentPage);
                };
                controls.appendChild(pageBtn);
            }

            var nextBtn = document.createElement('button');
            nextBtn.className = 'page-btn';
            nextBtn.textContent = '‚Ä∫';
            nextBtn.disabled = currentPage === totalPages || totalPages === 0;
            nextBtn.onclick = function() {
                if (currentPage < totalPages) {
                    currentPage++;
                    showPage(currentPage);
                }
            };
            controls.appendChild(nextBtn);

            showPage(currentPage);
        }

        function showPage(page) {
            var visibleRows = Array.from(document.querySelectorAll('#deviceTbody tr:not(.filtered-out)'));
            var start = (page - 1) * rowsPerPage;
            var end = start + rowsPerPage;

            visibleRows.forEach(function(row, idx) {
                if (idx >= start && idx < end) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });

            document.querySelectorAll('.page-btn[data-page]').forEach(function(btn) {
                btn.classList.toggle('active', parseInt(btn.dataset.page) === page);
            });
        }

        // CSV ÎÇ¥Î≥¥ÎÇ¥Í∏∞
        document.getElementById('exportCSV').addEventListener('click', function() {
            var rows = document.querySelectorAll('#deviceTbody tr:not(.filtered-out)');
            var csv = [];

            csv.push('ÏÇ¨ÏóÖÏû•,Í∑∏Î£π,ÏÑ§ÏπòÏû•ÏÜå,ÏãúÎ¶¨Ïñº,ÏÑ§ÏπòÏùº');

            rows.forEach(function(row) {
                if (row.style.display !== 'none') {
                    var branch = row.querySelector('[data-branch]').dataset.branch;
                    var group = row.querySelector('[data-group]').dataset.group;
                    var location = row.querySelector('[data-location]').dataset.location;
                    var serial = row.querySelector('[data-serial]').dataset.serial;
                    var date = row.querySelector('[data-date]').dataset.date;

                    csv.push([branch, group, location, serial, date].join(','));
                }
            });

            var csvContent = '\uFEFF' + csv.join('\n');
            var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            var link = document.createElement('a');
            var url = URL.createObjectURL(blob);

            link.setAttribute('href', url);
            link.setAttribute('download', 'Í∏∞Í∏∞Í¥ÄÎ¶¨_' + new Date().toISOString().split('T')[0] + '.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });

        // Ìñâ ÏÇ≠Ï†ú
        function deleteRow(rowIndex) {
            if (confirm('Ïù¥ Í∏∞Í∏∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                var row = document.querySelector('tr[data-row="' + rowIndex + '"]');
                if (row) {
                    row.remove();
                    updatePaginationInfo();
                    renderPagination();
                }
            }
        }

        document.getElementById('resetSeed').addEventListener('click', function() {
            if (confirm('ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞Î•º Ïû¨ÏÑ§Ï†ïÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                location.reload();
            }
        });

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            updatePaginationInfo();
            renderPagination();
        });
    </script>
</body>
</html>
